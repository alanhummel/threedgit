jQuery.fn.shake=function(){this.each(function(b){$(this).css({position:"absolute"});for(var a=1;a<=3;a++){$(this).animate({left:43},10).animate({left:23},50).animate({left:23},10).animate({left:13},50).animate({left:43},50).animate({left:33},50).animate({left:43},50)}});return this};$(document).ready(function(){$("#logo").shake()});easing="Expo.easeInOut";var icones=[["images/icons/em_processo_carga.png","Em processo"],["images/icons/em_processo_carga_com_recarga.png","Processo com recarga"],["images/icons/em_processo_pausa.png","Em processo de pausa"],["images/icons/em_processo_pausa_operador.png","Pausa por operador"],["images/icons/em_processo_recarga.png","Processo de recarga"],["images/icons/espera_programacao.png","Espera de programação"],["images/icons/parado_circuito_aberto.png","Circuito em aberto"],["images/icons/parado_temperatura_alta.png","Temperatura alta"],["images/icons/processo_encerrado_temp_emergencia.png","Temp. em emergência"],["images/icons/processo_finalizado.png","Processo finalizado"],["images/icons/processo_parado_corrente_alta.png","Corrente alta"],["images/icons/processo_parado_corrente_muito_baixa.png","Corrente elevada"],["images/icons/processo_parado_envio_plano.png","Envio do plano"],["images/icons/processo_parado_horario_ponta.png","Horário de Ponta"],["images/icons/processo_parado_temp_bateria_altissima.png","Temp. altíssima"],["images/icons/processo_parado_temp_dissipador_retificador.png","Temper. elevada do retif."],["images/icons/processo_parado_temp_sonda_baixa.png","Temp. da Sonda baixa"],["images/icons/retificador_nao_responde.png","Retificador não responde"],["images/icons/retificador_parado_manutencao.png","Retif. parado em man."],["images/icons/sem_comunicacao_interface.png","Sem comunicação com a interface"]];var table=[];var camera,scene,renderer;var controls;var objects=[];var targets={table:[]};$(function(){initialLoadAndStart();timelyUpdates()});function timelyUpdates(){setInterval(function(){updateJSONData()},5000)}function updateJSONData(){$.getJSON("doc/circuito27.json",function(b){console.log(b);for(var a=0;a<b.length;a++){updateFields(b,a)}})}function updateFields(k,f){var d=document.getElementById("C"+(f));var o=document.getElementById("imgId"+(f));var n=document.getElementById("circuitoId"+(f));var p=document.getElementById("endId"+(f));var j=document.getElementById("descricaoId"+(f));var h=document.getElementById("tensaoId"+(f));var m=document.getElementById("correnteId"+(f));var s=document.getElementById("cargaId"+(f));var l=document.getElementById("voltBatId"+(f));var c=document.getElementById("voltElemId"+(f));var a=document.getElementById("tempBatId"+(f));var q=document.getElementById("tempDissipId"+(f));var b=document.getElementById("faseId"+(f));var r=document.getElementById("tempoProcessoId"+(f));var g=document.getElementById("planoId"+(f));var i=false;var e=[];if(j.textContent.localeCompare(icones[k[f].icone][1])!=0){o.src=icones[k[f].icone][0];j.textContent=icones[k[f].icone][1];i=true;e.push(j);e.push(o)}if(n.textContent.localeCompare("Circuito "+k[f].circuitoNumero)!=0){n.textContent="Circuito "+k[f].circuitoNumero;i=true;e.push(n)}if(p.innerHTML.localeCompare(k[f].end)!=0){p.innerHTML=k[f].end;i=true;e.push(p)}if(h.textContent.localeCompare(k[f].tensao)!=0){h.textContent=k[f].tensao;i=true;e.push(h)}if(m.textContent.localeCompare(k[f].corrente)!=0){m.textContent=k[f].corrente;i=true;e.push(m)}if(s.textContent.localeCompare(k[f].carga)!=0){s.textContent=k[f].carga;i=true;e.push(s)}if(l.textContent.localeCompare(k[f].voltBat)!=0){l.textContent=k[f].voltBat;i=true;e.push(l)}if(c.textContent.localeCompare(k[f].voltElem)!=0){c.textContent=k[f].voltElem;i=true;e.push(c)}if(a.textContent.localeCompare(k[f].tempBat)!=0){a.textContent=k[f].tempBat;i=true;e.push(a)}if(q.textContent.localeCompare(k[f].tempDissip)!=0){q.textContent=k[f].tempDissip;i=true;e.push(q)}if(b.textContent.localeCompare(k[f].fase)!=0){b.textContent=k[f].fase;i=true;e.push(b)}if(r.textContent.localeCompare(k[f].tempoProcesso)!=0){r.textContent=k[f].tempoProcesso;i=true;e.push(r)}if(g.textContent.localeCompare(k[f].plano)!=0){g.textContent=k[f].plano;i=true;e.push(g)}if(i){$(d).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).animate({opacity:100},{duration:10,complete:function(){for(var u=0;u<e.length;u++){var t=$(e[u]).css("font-size");$(e[u]).animate({fontSize:"31px"}).animate({fontSize:t}).animate({fontSize:"31px"}).animate({fontSize:t}).animate({fontSize:"31px"}).animate({fontSize:t}).animate({fontSize:"31px"}).animate({fontSize:t})}}})}}function initialLoadAndStart(){$.getJSON("doc/circuito27.json",function(b){console.log(b);var c=4;var a=4;initVisualization(b);animate()})}function initVisualization(v){camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,10000);camera.position.z=2384;scene=new THREE.Scene();var n=4;var c=4;for(var A=0;A<v.length;A++){var d=document.createElement("div");d.className="element";d.style.backgroundColor="rgba(227,227,227,0.50)";d.id="C"+A;d.setAttribute("onclick","testClick('"+d.id+"')");var G=document.createElement("div");G.textContent="Circuito "+v[A].circuitoNumero;G.className="circuito";G.id="circuitoId"+A;d.appendChild(G);var f=document.createElement("div");f.className="end";f.innerHTML=v[A].end;f.id="endId"+A;d.appendChild(f);var u=document.createElement("div");u.textContent=icones[v[A].icone][1];u.className="descricao";u.id="descricaoId"+A;d.appendChild(u);var B=document.createElement("div");B.textContent="Tensão: ";B.className="dados";var h=document.createElement("b");h.textContent=v[A].tensao;h.style="color:#FF0000";h.id="tensaoId"+A;B.appendChild(h);B.appendChild(document.createElement("br"));var a=document.createElement("em");a.textContent="Corrente: ";B.appendChild(a);var m=document.createElement("b");m.textContent=v[A].corrente;m.style="color:#B87AC4";m.id="correnteId"+A;B.appendChild(m);B.appendChild(document.createElement("br"));var w=document.createElement("em");w.textContent="Carga: ";B.appendChild(w);var t=document.createElement("b");t.textContent=v[A].carga;t.id="cargaId"+A;t.style="color:#00FF00";B.appendChild(t);B.appendChild(document.createElement("br"));var j=document.createElement("em");j.textContent="Volt/Elem.: ";B.appendChild(j);var x=document.createElement("b");x.textContent=v[A].voltElem;x.style="color:#000000";x.id="voltElemId"+A;B.appendChild(x);B.appendChild(document.createElement("br"));var y=document.createElement("em");y.textContent="Volt/Bat.:";B.appendChild(y);var p=document.createElement("b");p.textContent=v[A].voltBat;p.style="color:#FF0000";p.id="voltBatId"+A;B.appendChild(p);B.appendChild(document.createElement("br"));var s=document.createElement("em");s.textContent="Temp. Bat.:";B.appendChild(s);var F=document.createElement("b");F.textContent=v[A].tempBat;F.style="color:#000000";F.id="tempBatId"+A;B.appendChild(F);B.appendChild(document.createElement("br"));var o=document.createElement("em");o.textContent="Temp. Dissip.:";B.appendChild(o);var z=document.createElement("b");z.textContent=v[A].tempDissip;z.style="color:#000000";z.id="tempDissipId"+A;B.appendChild(z);B.appendChild(document.createElement("br"));var g=document.createElement("em");g.textContent="Fase:";B.appendChild(g);var E=document.createElement("b");E.textContent=v[A].fase;E.style="color:#000000";E.id="faseId"+A;B.appendChild(E);d.appendChild(B);var D=document.createElement("div");D.className="dadosAbaixo";var l=document.createElement("em");l.textContent="Tempo Processo: ";D.appendChild(l);var C=document.createElement("b");C.textContent=v[A].tempoProcesso;C.style="color:#000000";C.id="tempoProcessoId"+A;D.appendChild(C);D.appendChild(document.createElement("br"));var r=document.createElement("em");r.textContent="Plano: ";D.appendChild(r);var H=document.createElement("b");H.textContent=v[A].plano;H.style="color:#000000";H.id="planoId"+A;D.appendChild(H);d.appendChild(D);var J=document.createElement("img");J.className="image";J.src=icones[v[A].icone][0];J.id="imgId"+A;d.appendChild(J);var I=new THREE.CSS3DObject(d);I.position.x=0;I.position.y=0;I.position.z=Math.random()-20000;scene.add(I);objects.push(I);var e=A%c;var k=(A-e)/c;var I=new THREE.Object3D();I.position.x=(e*360)-540;I.position.y=-(k*360)+610;I.position.z=0;targets.table.push(I)}renderer=new THREE.CSS3DRenderer();renderer.setSize(window.innerWidth,window.innerHeight);renderer.domElement.style.position="absolute";document.getElementById("container").appendChild(renderer.domElement);controls=new THREE.TrackballControls(camera,renderer.domElement);controls.noRotate=true;controls.rotateSpeed=0.5;controls.minDistance=1000;controls.maxDistance=4300;controls.animationOn=true;controls.addEventListener("change",render);var b=document.getElementById("center");b.addEventListener("click",function(i){controls.reset(true)},false);var q=document.getElementById("ReturnToBankButton");q.addEventListener("click",function(i){transitionOutCircuits(1000)},false);transitionInCircuits(targets.table,1000);window.addEventListener("resize",onWindowResize,false)}function transitionInCircuits(a,e){TWEEN.removeAll();for(var c=0;c<objects.length;c++){var b=objects[c];var d=a[c];new TWEEN.Tween(b.position).to({x:d.position.x,y:d.position.y,z:d.position.z},Math.random()*e+e).easing(TWEEN.Easing.Exponential.InOut).start();new TWEEN.Tween(b.rotation).to({x:d.rotation.x,y:d.rotation.y,z:d.rotation.z},Math.random()*e+e).easing(TWEEN.Easing.Exponential.InOut).start()}new TWEEN.Tween(this).to({},e*2).onUpdate(render).start()}function transitionOutCircuits(d){TWEEN.removeAll();var c;for(var b=0;b<objects.length;b++){var a=objects[b];c=new TWEEN.Tween(a.position).to({x:0,y:0,z:-20000},Math.random()*d+d).easing(TWEEN.Easing.Exponential.InOut).start();new TWEEN.Tween(a.rotation).to({x:0,y:0,z:-20000},Math.random()*d+d).easing(TWEEN.Easing.Exponential.InOut).start()}c.onComplete(redirectToPage);new TWEEN.Tween(this).to({},d*2).onUpdate(render).start()}function redirectToPage(){window.location.href="dashboardBank.html"}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);render()}function animate(){requestAnimationFrame(animate);TWEEN.update();controls.update()}function render(){renderer.render(scene,camera)}function testClick(a){alert(a)};