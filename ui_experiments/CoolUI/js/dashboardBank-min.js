easing="Expo.easeInOut";var selectedBank;var table=[];var camera,scene,renderer;var controls;var objects=[];var targets={table:[]};$(function(){initialLoadAndStart();timelyUpdates()});function updateJSONData(){var a;$.getJSON("doc/bancos.json",function(d){console.log(d);var c;for(var b=0;b<d.length;b++){a=document.getElementById("B"+(b+1));c=a.style.backgroundColor;c=c.replace(/\s/g,"");c=c.substr(0,12);if(c.localeCompare(d[b].colorStatus.substr(0,12))!=0){a.style.backgroundColor=d[b].colorStatus;$("#B"+(b+1)).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100)}}})}function initialLoadAndStart(){$.getJSON("doc/bancos.json",function(f){console.log(f);var d=4;var b=7;for(var a=0;a<f.length;a++){var c=a%b;var e=(a-c)/b;table.push(f[a].nome);table.push(c+1);table.push(e+1);table.push(f[a].colorStatus)}initVisualization();animate()})}function timelyUpdates(){setInterval(function(){updateJSONData()},5000)}function initVisualization(){camera=new THREE.PerspectiveCamera(40,window.innerWidth/window.innerHeight,1,10000);camera.position.z=2384;scene=new THREE.Scene();for(var d=0;d<table.length;d+=4){var e=((d/4)+1);var c=document.createElement("div");c.className="element";c.style.backgroundColor=table[d+3];c.id="B"+e;c.setAttribute("onclick","openBank('"+c.id+"')");var f=document.createElement("div");f.className="symbol";f.textContent=table[d];c.appendChild(f);var a=new THREE.CSS3DObject(c);a.position.x=Math.random()*20000-2000;a.position.y=-20000-2000;a.position.z=-20000-2000;scene.add(a);objects.push(a);var a=new THREE.Object3D();a.position.x=(table[d+1]*360)-1440;a.position.y=-(table[d+2]*360)+940;a.position.z=0;targets.table.push(a)}renderer=new THREE.CSS3DRenderer();renderer.setSize(window.innerWidth,window.innerHeight);renderer.domElement.style.position="absolute";document.getElementById("container").appendChild(renderer.domElement);controls=new THREE.TrackballControls(camera,renderer.domElement);controls.noRotate=true;controls.rotateSpeed=0.5;controls.minDistance=1000;controls.maxDistance=4300;controls.animationOn=true;controls.addEventListener("change",render);var b=document.getElementById("center");b.addEventListener("click",function(g){controls.reset(true)},false);transitionInBanks(targets.table,2000);window.addEventListener("resize",onWindowResize,false)}function transitionInBanks(a,e){TWEEN.removeAll();for(var c=0;c<objects.length;c++){var b=objects[c];var d=a[c];new TWEEN.Tween(b.position).to({x:d.position.x,y:d.position.y,z:d.position.z},Math.random()*e+e).easing(TWEEN.Easing.Exponential.InOut).start();new TWEEN.Tween(b.rotation).to({x:d.rotation.x,y:d.rotation.y,z:d.rotation.z},Math.random()*e+e).easing(TWEEN.Easing.Exponential.InOut).start()}new TWEEN.Tween(this).to({},e*2).onUpdate(render).start()}function animateElementTransition(c,d){TWEEN.removeAll();var a=objects[c];var b=new TWEEN.Tween(a.position).to({x:camera.position.x,y:camera.position.y,z:camera.position.z},Math.random()*d+d).easing(TWEEN.Easing.Exponential.InOut).start();new TWEEN.Tween(a.rotation).to({x:camera.rotation.x,y:camera.rotation.y,z:camera.rotation.z},Math.random()*d+d).easing(TWEEN.Easing.Exponential.InOut).start();b.onComplete(redirectToPage);new TWEEN.Tween(this).to({},d*2).onUpdate(render).start()}function redirectToPage(){window.location.href="dashboardCircuit.html?bank="+selectedBank}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);render()}function animate(){requestAnimationFrame(animate);TWEEN.update();controls.update()}function render(){renderer.render(scene,camera)}function openBank(b){var a=obtainTableIndex(b);selectedBank=b;animateElementTransition(a,500)}function obtainTableObject(b){for(var e=0,a=objects.length;e<a;++e){var c=objects[e];var d=c.element;if(d.id==b){return c}}return null}function obtainTableIndex(b){for(var e=0,a=objects.length;e<a;++e){var c=objects[e];var d=c.element;if(d.id==b){return e}}return null};